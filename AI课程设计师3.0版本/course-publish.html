<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯¾ç¨‹å‘å¸ƒè®¾ç½® - AIè¯¾ç¨‹è®¾è®¡å¸ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-in': 'slideIn 0.3s ease-out'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .tab-active {
            border-color: #3b82f6;
            border-width: 2px;
            background-color: #eff6ff;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-14">
                <div class="flex items-center space-x-4">
                    <button id="backBtn" class="flex items-center space-x-2 text-gray-500 hover:text-gray-700 transition-colors">
                        <i class="fas fa-arrow-left text-sm"></i>
                        <span class="text-sm">è¯¾ç¨‹åç§°è¯¾ç¨‹åç§°è¯¾ç¨‹...</span>
                    </button>
                </div>
                
                <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
                <div class="flex items-center space-x-8">
                    <div class="flex items-center space-x-2">
                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs">
                            <i class="fas fa-check"></i>
                        </div>
                        <span class="text-sm text-gray-600">åŸºæœ¬ä¿¡æ¯</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs">
                            <i class="fas fa-check"></i>
                        </div>
                        <span class="text-sm text-gray-600">è¯¾ç¨‹ç›®å½•</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs">3</div>
                        <span class="text-sm text-blue-600 font-medium">å‘å¸ƒè®¾ç½®</span>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <button id="saveDraftBtn" class="px-3 py-1.5 text-gray-600 hover:text-gray-800 text-sm font-medium transition-colors">
                        å­˜è‰ç¨¿
                    </button>
                    <button id="publishBtn" class="px-4 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors text-sm">
                        å‘å¸ƒ
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="min-h-screen bg-gray-50">
        <div class="max-w-6xl mx-auto p-6 space-y-8">
            <!-- å­¦å‘˜å®‰æ’ -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h2 class="text-lg font-medium text-gray-900 mb-6">å­¦å‘˜å®‰æ’</h2>
                
                <!-- å¿…ä¿®å­¦å‘˜ -->
                <div class="mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-2">
                            <span class="text-red-500 text-sm">*</span>
                            <span class="text-gray-900 font-medium text-sm">å¿…ä¿®å­¦å‘˜</span>
                            <span class="text-blue-500 text-sm cursor-pointer hover:underline">ç®¡ç†å­¦å‘˜(å·²å®‰æ’50äºº) ></span>
                        </div>
                        <button class="px-4 py-2 border border-blue-500 text-blue-500 rounded-md hover:bg-blue-50 transition-colors text-sm flex items-center">
                            <i class="fas fa-plus mr-1 text-xs"></i>
                            é€‰æ‹©å­¦å‘˜
                        </button>
                    </div>
                    
                    <!-- å­¦å‘˜æ ‡ç­¾ -->
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            æ™æºª
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            é»‘æ¡ƒ
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            çº¢æ¡ƒ
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            å­™ç»ç’ƒ
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            ç‹å¤šé±¼
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            ç”¨æˆ·ç»„åç§°
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            ç”¨æˆ·ç»„åç§°
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            éƒ¨é—¨åç§°åç§°åç§°
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                    </div>
                </div>
                
                <!-- é€‰ä¿®å­¦å‘˜ -->
                <div>
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-2">
                            <span class="text-gray-900 font-medium text-sm">é€‰ä¿®å­¦å‘˜</span>
                            <span class="text-blue-500 text-sm cursor-pointer hover:underline">ç®¡ç†å­¦å‘˜(å·²å®‰æ’50äºº) ></span>
                        </div>
                        <button class="px-4 py-2 border border-blue-500 text-blue-500 rounded-md hover:bg-blue-50 transition-colors text-sm flex items-center">
                            <i class="fas fa-plus mr-1 text-xs"></i>
                            é€‰æ‹©å­¦å‘˜
                        </button>
                    </div>
                    
                    <!-- å­¦å‘˜æ ‡ç­¾ -->
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            æ™æºª
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            é»‘æ¡ƒ
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            çº¢æ¡ƒ
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            å­™ç»ç’ƒ
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            ç‹å¤šé±¼
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center">
                            ç”¨æˆ·ç»„åç§°
                            <button class="ml-2 text-gray-400 hover:text-gray-600">Ã—</button>
                        </span>
                    </div>
                </div>
            </div>
            
            <!-- å­¦ä¹ è®¾ç½® -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h2 class="text-lg font-medium text-gray-900 mb-2">å­¦ä¹ è®¾ç½®</h2>
                <p class="text-gray-500 text-sm mb-6">è¯·é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬æˆ–ç›´æ¥ä½¿ç”¨ï¼Œæ›´æ”¹åè¯·æ³¨æ„å®šä¹‰å„ç§è®¾ç½®</p>
                
                <!-- æ¨¡æ¿é€‰æ‹©é€‰é¡¹å¡ -->
                <div class="grid grid-cols-4 gap-4 mb-6">
                    <!-- è‡ªå®šä¹‰è®¾ç½® -->
                    <div class="tab-active border rounded-lg p-4 cursor-pointer hover:shadow-sm transition-all">
                        <h3 class="font-medium text-gray-900 text-sm mb-2">è‡ªå®šä¹‰è®¾ç½®</h3>
                        <p class="text-gray-500 text-xs leading-relaxed">é€‚ç”¨äºçµæ´»å­¦ä¹ ç±»å‹çš„è¯¾ç¨‹ï¼Œè‡´è‚²å­¦å‘˜è‡ªç”±è‡ªä¸»å­¦ä¹ </p>
                    </div>
                    
                    <!-- ä¸¥æ ¼ç›‘ç®¡å‹æ¨¡ç‰ˆ -->
                    <div class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-sm transition-all">
                        <h3 class="font-medium text-gray-900 text-sm mb-2">ä¸¥æ ¼ç›‘ç®¡å‹æ¨¡ç‰ˆ</h3>
                        <p class="text-gray-500 text-xs leading-relaxed">é€‚ç”¨äºå¿…ä¿®ã€åˆè§„ç±»è¯¾ç¨‹ï¼Œå¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ç›‘æ§</p>
                    </div>
                    
                    <!-- ä¸¥æ ¼ç›‘ç®¡ç£ä¿ƒæ¨¡ç‰ˆ -->
                    <div class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-sm transition-all">
                        <h3 class="font-medium text-gray-900 text-sm mb-2">ä¸¥æ ¼ç›‘ç®¡ç£ä¿ƒæ¨¡ç‰ˆ</h3>
                        <p class="text-gray-500 text-xs leading-relaxed">é€‚ç”¨äºå¿…ä¿®ã€åˆè§„ç±»è¯¾ç¨‹ï¼Œå¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ç›‘æ§</p>
                    </div>
                    
                    <!-- æ›´å¤šæ¨¡ç‰ˆ -->
                    <div class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:shadow-sm transition-all">
                        <h3 class="font-medium text-gray-900 text-sm mb-2">æ›´å¤šæ¨¡ç‰ˆ</h3>
                        <p class="text-gray-500 text-xs leading-relaxed"></p>
                    </div>
                </div>
                
                <!-- è®¾ç½®é¡¹é“¾æ¥ -->
                <div class="text-center mb-6">
                    <div class="inline-flex items-center space-x-6 text-blue-500 text-sm">
                        <button class="hover:underline cursor-pointer">æ¶ˆæ¯æé†’</button>
                        <span class="text-gray-300">â€¢</span>
                        <button class="hover:underline cursor-pointer">å­¦ä¹ æ¨¡å¼</button>
                        <span class="text-gray-300">â€¢</span>
                        <button class="hover:underline cursor-pointer">å­¦ä¹ ç›‘ç£ç®¡ç†é¡¹ç›®</button>
                        <i class="fas fa-chevron-down ml-2 text-xs"></i>
                    </div>
                </div>

                <!-- æŠ˜å é¢æ¿åŒºåŸŸ -->
                <div class="space-y-4">
                    <!-- æ¶ˆæ¯æé†’ - é»˜è®¤å±•å¼€ -->
                    <div class="border border-gray-200 rounded-lg">
                        <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50 transition-colors collapsible-toggle" data-target="notifications">
                            <div class="flex items-center space-x-3">
                                <div class="w-1 h-6 bg-blue-500 rounded"></div>
                                <span class="font-medium text-gray-900 text-sm">æ¶ˆæ¯æé†’</span>
                            </div>
                            <i class="fas fa-chevron-up text-gray-400 transition-transform collapsible-icon"></i>
                        </button>
                        <div class="collapsible-content p-4 pt-0" id="notifications">
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-medium text-gray-900 text-sm mb-2">æ¨é€å¾…åŠé€šçŸ¥</h4>
                                    <p class="text-gray-500 text-sm leading-relaxed">æŒ‡æ´¾èŒƒå›´å†…å­¦å‘˜çš„è¯¾ç¨‹ä¿¡æ¯ä»¥å…¶ä»–æ–¹å¼æç¤ºï¼Œè¯¾ç¨‹æ¨é€å®Œæˆæ”¹é€šçŸ¥ï¼Œç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ç›¸å…³äººå‘˜</p>
                                </div>
                                <div>
                                    <h4 class="font-medium text-gray-900 text-sm mb-2">æœªå­¦æé†’è®¾ç½®</h4>
                                    <p class="text-gray-500 text-sm leading-relaxed">æ ¹æ®æ¨èå­¦ä¹ æœŸé—´æœªå®Œæˆè¯¾ç¨‹çš„å¿…ä¿®å­¦å‘˜è¿›è¡Œå­¦ä¹ æé†’</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å­¦ä¹ æ¨¡å¼ -->
                    <div class="border border-gray-200 rounded-lg">
                        <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50 transition-colors collapsible-toggle" data-target="learning-mode">
                            <div class="flex items-center space-x-3">
                                <div class="w-1 h-6 bg-blue-500 rounded"></div>
                                <span class="font-medium text-gray-900 text-sm">å­¦ä¹ æ¨¡å¼</span>
                            </div>
                            <i class="fas fa-chevron-up text-gray-400 transition-transform collapsible-icon" style="transform: rotate(180deg);"></i>
                        </button>
                        <div class="collapsible-content hidden" id="learning-mode">
                            <div class="p-4 pt-0">
                                <div class="space-y-4">
                                    <div>
                                        <h4 class="font-medium text-gray-900 text-sm mb-2">å­¦ä¹ è¿›åº¦æ§åˆ¶</h4>
                                        <p class="text-gray-500 text-sm leading-relaxed">è®¾ç½®å­¦å‘˜å­¦ä¹ è¯¾ç¨‹çš„è¿›åº¦è¦æ±‚å’Œå®Œæˆæ ‡å‡†</p>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-900 text-sm mb-2">å­¦ä¹ æ—¶é•¿è¦æ±‚</h4>
                                        <p class="text-gray-500 text-sm leading-relaxed">é…ç½®æ¯èŠ‚è¯¾ç¨‹çš„æœ€ä½å­¦ä¹ æ—¶é•¿è¦æ±‚</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å­¦ä¹ ç›‘æ§ -->
                    <div class="border border-gray-200 rounded-lg">
                        <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50 transition-colors collapsible-toggle" data-target="learning-monitor">
                            <div class="flex items-center space-x-3">
                                <div class="w-1 h-6 bg-blue-500 rounded"></div>
                                <span class="font-medium text-gray-900 text-sm">å­¦ä¹ ç›‘æ§</span>
                            </div>
                            <i class="fas fa-chevron-up text-gray-400 transition-transform collapsible-icon" style="transform: rotate(180deg);"></i>
                        </button>
                        <div class="collapsible-content hidden" id="learning-monitor">
                            <div class="p-4 pt-0">
                                <div class="space-y-4">
                                    <div>
                                        <h4 class="font-medium text-gray-900 text-sm mb-2">å­¦ä¹ è¡Œä¸ºç›‘æ§</h4>
                                        <p class="text-gray-500 text-sm leading-relaxed">ç›‘æ§å­¦å‘˜çš„å­¦ä¹ è¡Œä¸ºï¼ŒåŒ…æ‹¬å­¦ä¹ æ—¶é•¿ã€è¿›åº¦ç­‰æ•°æ®</p>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-900 text-sm mb-2">é˜²ä½œå¼Šè®¾ç½®</h4>
                                        <p class="text-gray-500 text-sm leading-relaxed">è®¾ç½®é˜²æ­¢å­¦å‘˜å¿«è¿›ã€æŒ‚æœºç­‰ä½œå¼Šè¡Œä¸ºçš„ç›‘æ§æœºåˆ¶</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å…¶ä»– -->
                    <div class="border border-gray-200 rounded-lg">
                        <button class="w-full flex items-center justify-between p-4 text-left hover:bg-gray-50 transition-colors collapsible-toggle" data-target="others">
                            <div class="flex items-center space-x-3">
                                <div class="w-1 h-6 bg-blue-500 rounded"></div>
                                <span class="font-medium text-gray-900 text-sm">å…¶ä»–</span>
                            </div>
                            <i class="fas fa-chevron-up text-gray-400 transition-transform collapsible-icon" style="transform: rotate(180deg);"></i>
                        </button>
                        <div class="collapsible-content hidden" id="others">
                            <div class="p-4 pt-0">
                                <div class="space-y-4">
                                    <div>
                                        <h4 class="font-medium text-gray-900 text-sm mb-2">è¯ä¹¦è®¾ç½®</h4>
                                        <p class="text-gray-500 text-sm leading-relaxed">é…ç½®è¯¾ç¨‹å®Œæˆåçš„è¯ä¹¦ç”Ÿæˆå’Œå‘æ”¾è®¾ç½®</p>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-900 text-sm mb-2">è¯„ä»·è®¾ç½®</h4>
                                        <p class="text-gray-500 text-sm leading-relaxed">å¼€å¯å­¦å‘˜å¯¹è¯¾ç¨‹çš„è¯„ä»·åŠŸèƒ½å’Œè¯„ä»·è§„åˆ™</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åº•éƒ¨æ“ä½œåŒºåŸŸ -->
        <div class="border-t border-gray-200 bg-white p-4 mt-8">
            <div class="max-w-6xl mx-auto flex justify-between items-center">
                <button id="saveTemplateBtn" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors text-sm">
                    å­˜ä¸ºæ¨¡ç‰ˆ
                </button>
                <button id="saveBtn" class="px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors text-sm">
                    ä¿å­˜
                </button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€çŠ¶æ€ç®¡ç†
        const AppState = {
            courseData: null,
            selectedTemplate: 'custom'
        };

        // åˆå§‹åŒ–åº”ç”¨
        function initApp() {
            // åŠ è½½ä¼ é€’çš„æ•°æ®
            loadCourseData();
            
            // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
            initEventListeners();
            
            // åˆå§‹åŒ–æ¨¡æ¿é€‰æ‹©
            initTemplateSelection();
            
            // åˆå§‹åŒ–æŠ˜å é¢æ¿
            initCollapsiblePanels();
        }

        // åŠ è½½è¯¾ç¨‹æ•°æ®
        function loadCourseData() {
            try {
                const courseData = JSON.parse(sessionStorage.getItem('publishCourseData') || sessionStorage.getItem('editCourseData') || '{}');
                AppState.courseData = courseData;
                
                console.log('åŠ è½½çš„è¯¾ç¨‹æ•°æ®:', courseData);
            } catch (error) {
                console.error('åŠ è½½è¯¾ç¨‹æ•°æ®å¤±è´¥:', error);
                // ç”Ÿæˆé»˜è®¤æ•°æ®
                AppState.courseData = {
                    generatedContent: {
                        title: 'æ•°æ®åˆ†æä¸“ä¸šåŸ¹è®­è¯¾ç¨‹'
                    }
                };
            }
        }

        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
        function initEventListeners() {
            // è¿”å›æŒ‰é’®
            document.getElementById('backBtn').addEventListener('click', () => {
                if (confirm('ç¡®å®šè¦è¿”å›å—ï¼Ÿæœªä¿å­˜çš„è®¾ç½®å¯èƒ½ä¼šä¸¢å¤±ã€‚')) {
                    window.close();
                }
            });

            // ä¿å­˜è‰ç¨¿æŒ‰é’®
            document.getElementById('saveDraftBtn').addEventListener('click', () => {
                saveDraft();
            });

            // å‘å¸ƒæŒ‰é’®
            document.getElementById('publishBtn').addEventListener('click', () => {
                publishCourse();
            });

            // ä¿å­˜æ¨¡ç‰ˆæŒ‰é’®
            document.getElementById('saveTemplateBtn').addEventListener('click', () => {
                saveTemplate();
            });

            // ä¿å­˜æŒ‰é’®
            document.getElementById('saveBtn').addEventListener('click', () => {
                saveSettings();
            });

            // å­¦å‘˜æ ‡ç­¾åˆ é™¤äº‹ä»¶
            document.querySelectorAll('.bg-gray-100 button').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.target.closest('span').remove();
                });
            });
        }

        // åˆå§‹åŒ–æ¨¡æ¿é€‰æ‹©
        function initTemplateSelection() {
            const templates = document.querySelectorAll('.grid > div');
            
            templates.forEach((template, index) => {
                template.addEventListener('click', () => {
                    // ç§»é™¤æ‰€æœ‰activeçŠ¶æ€
                    templates.forEach(t => t.classList.remove('tab-active'));
                    
                    // æ·»åŠ activeçŠ¶æ€åˆ°å½“å‰é€‰ä¸­çš„æ¨¡æ¿
                    template.classList.add('tab-active');
                    
                    // æ›´æ–°çŠ¶æ€
                    const templateTypes = ['custom', 'strict', 'monitor', 'more'];
                    AppState.selectedTemplate = templateTypes[index];
                    
                    console.log('é€‰æ‹©äº†æ¨¡æ¿:', AppState.selectedTemplate);
                });
            });
        }

        // ä¿å­˜è‰ç¨¿
        function saveDraft() {
            // ä¿å­˜å‘å¸ƒè®¾ç½®åˆ°sessionStorage
            const draftData = {
                ...AppState.courseData,
                publishSettings: {
                    selectedTemplate: AppState.selectedTemplate,
                    savedAt: new Date().toISOString()
                }
            };
            sessionStorage.setItem('publishCourseData', JSON.stringify(draftData));
            
            // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
            showNotification('è‰ç¨¿å·²ä¿å­˜', 'success');
        }

        // ä¿å­˜è®¾ç½®
        function saveSettings() {
            // ä¿å­˜è®¾ç½®
            saveDraft();
            showNotification('è®¾ç½®å·²ä¿å­˜', 'success');
        }

        // ä¿å­˜ä¸ºæ¨¡ç‰ˆ
        function saveTemplate() {
            showNotification('æ¨¡ç‰ˆå·²ä¿å­˜', 'success');
        }

        // å‘å¸ƒè¯¾ç¨‹
        function publishCourse() {
            if (confirm('ç¡®å®šè¦å‘å¸ƒè¿™é—¨è¯¾ç¨‹å—ï¼Ÿå‘å¸ƒåå­¦å‘˜å°±å¯ä»¥å¼€å§‹å­¦ä¹ äº†ã€‚')) {
                // å…ˆä¿å­˜å½“å‰è®¾ç½®
                saveDraft();
                
                // æ¨¡æ‹Ÿå‘å¸ƒè¿‡ç¨‹
                const publishBtn = document.getElementById('publishBtn');
                const originalText = publishBtn.innerHTML;
                
                publishBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>å‘å¸ƒä¸­...';
                publishBtn.disabled = true;
                
                setTimeout(() => {
                    publishBtn.innerHTML = '<i class="fas fa-check mr-2"></i>å‘å¸ƒæˆåŠŸ';
                    publishBtn.className = 'px-4 py-1.5 bg-green-500 text-white rounded-md cursor-default text-sm';
                    
                    // æ˜¾ç¤ºå‘å¸ƒæˆåŠŸé€šçŸ¥
                    showNotification('ğŸ‰ è¯¾ç¨‹å‘å¸ƒæˆåŠŸï¼', 'success');
                    
                    // 3ç§’åå¯ä»¥é€‰æ‹©å…³é—­çª—å£
                    setTimeout(() => {
                        if (confirm('è¯¾ç¨‹å·²æˆåŠŸå‘å¸ƒï¼æ˜¯å¦å…³é—­å‘å¸ƒé¡µé¢ï¼Ÿ')) {
                            window.close();
                        }
                    }, 3000);
                }, 2000);
            }
        }

        // åˆå§‹åŒ–æŠ˜å é¢æ¿
        function initCollapsiblePanels() {
            const toggles = document.querySelectorAll('.collapsible-toggle');
            
            toggles.forEach(toggle => {
                toggle.addEventListener('click', () => {
                    const targetId = toggle.getAttribute('data-target');
                    const content = document.getElementById(targetId);
                    const icon = toggle.querySelector('.collapsible-icon');
                    
                    if (content.classList.contains('hidden')) {
                        // å±•å¼€
                        content.classList.remove('hidden');
                        icon.style.transform = 'rotate(0deg)';
                    } else {
                        // æ”¶èµ·
                        content.classList.add('hidden');
                        icon.style.transform = 'rotate(180deg)';
                    }
                });
            });
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-50 px-4 py-2 rounded-md shadow-lg transition-all duration-300 ${
                type === 'success' ? 'bg-green-500 text-white' : 
                type === 'error' ? 'bg-red-500 text-white' : 
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 2000);
        }

        // å¯åŠ¨åº”ç”¨
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html> 